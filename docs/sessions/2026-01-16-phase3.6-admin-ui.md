# Phase 3.6: Admin UI (Standalone Application)

**Date:** 2026-01-16
**Type:** Implementation
**Status:** Complete

---

## Objective

Create standalone admin application for managing topic queue, reviewing blog posts, and configuring scheduler/auto-suggest settings.

**Key Requirement:** Admin must be COMPLETELY SEPARATE application (not part of main frontend) with network-level access control.

---

## Initial Approach (Incorrect)

Initially implemented admin pages within main frontend at `/src/frontend/src/pages/admin/`:
- TopicQueuePage, ReviewPage, SettingsPage components
- Added admin routes to main App.tsx
- Added admin nav links to TopNav

**Problem:** User correctly pointed out admin must be COMPLETELY SEPARATE application for security:
- Network-level access control
- Separate deployment
- Physical/network restrictions (not authentication-based)

---

## Corrected Approach

### 1. Remove Admin from Main Frontend

**Removed:**
- `/src/frontend/src/pages/admin/` directory (user deleted)
- Admin routes from `/src/frontend/src/App.tsx`
- Admin navigation from `/src/frontend/src/components/TopNav.tsx` and `.css`
- Admin types from `/src/frontend/src/types/index.ts`
- Admin API methods from `/src/frontend/src/services/api.ts`

Main frontend now public-facing only (Ask, Read, Audits).

### 2. Create Standalone Admin App

**Location:** `/src/admin/` (new Vite + React + TypeScript project)

**Initialization:**
```bash
cd /src
npm create vite@latest admin -- --template react-ts
cd admin
npm install react-router-dom
```

**Configuration:** `/src/admin/vite.config.ts`
- Port: 5174 (main frontend on 5173)
- Host: 0.0.0.0 (accessible on internal network)
- Proxy: /api → http://192.168.50.10:8008 (same backend)

---

## Admin Application Structure

```
/src/admin/
├── src/
│   ├── api.ts                    # Admin API client
│   ├── types.ts                  # TypeScript types
│   ├── components/
│   │   ├── Navigation.tsx        # Admin nav bar
│   │   └── Navigation.css
│   ├── pages/
│   │   ├── TopicQueuePage.tsx    # Topic management
│   │   ├── TopicQueuePage.css
│   │   ├── ReviewPage.tsx        # Blog post review
│   │   ├── ReviewPage.css
│   │   ├── SettingsPage.tsx      # Scheduler/auto-suggest config
│   │   └── SettingsPage.css
│   ├── App.tsx                   # Routing configuration
│   ├── App.css
│   └── index.css                 # Base styles
├── package.json
└── vite.config.ts
```

---

## Implemented Features

### Topic Queue Management Page (`/topics`)

**Features:**
- List all topics with pagination
- Filter by status (queued, processing, completed, failed)
- Filter by review_status (pending_review, approved, rejected, needs_revision)
- Add new topic (manual entry with priority 1-10)
- Edit topic (text, priority, status)
- Delete topic (with confirmation)
- Display badges for status and review status
- Show error messages for failed topics

**API Endpoints:**
- `GET /api/admin/topics` (with filters)
- `POST /api/admin/topics`
- `PUT /api/admin/topics/{id}`
- `DELETE /api/admin/topics/{id}`

### Review Interface Page (`/review`)

**Features:**
- List pending reviews (blog posts awaiting approval)
- Expandable review items showing:
  - Blog post title and full article body (synthesized prose)
  - Component claim cards (expandable with full details)
  - Sources, categories, verdict badges
- Three review actions:
  - **Approve & Publish:** Sets published_at, makes blog visible in Read page
  - **Request Revision:** Specify revision scope (decomposer/claim_pipeline/composer)
  - **Reject:** Blog not published, claim cards remain in database
- Reviewer name and notes/feedback required

**API Endpoints:**
- `GET /api/admin/review/pending`
- `POST /api/admin/review/{id}/approve`
- `POST /api/admin/review/{id}/reject`
- `POST /api/admin/review/{id}/revision`

### Settings Page (`/settings`)

**Scheduler Configuration:**
- Enable/disable scheduler
- Posts per day (1-10)
- Cron schedule (hour/minute, 24-hour format)
- "Run Now" button (manual trigger)

**Auto-Suggest Configuration:**
- Enable/disable auto-suggest
- Max topics per run (1-20)
- Similarity threshold (0.5-1.0 for deduplication)
- "Trigger Now" button (manual topic discovery)

**API Endpoints:**
- `GET /api/admin/scheduler/settings`
- `PUT /api/admin/scheduler/settings`
- `POST /api/admin/scheduler/run-now`
- `GET /api/admin/autosuggest/settings`
- `PUT /api/admin/autosuggest/settings`
- `POST /api/admin/autosuggest/trigger`

---

## Technical Details

### API Client (`src/admin/src/api.ts`)

Standalone admin API client with 13 methods:
- Topic management: get, create, update, delete
- Review workflow: get pending, approve, reject, request revision
- Scheduler: get settings, update settings, run now
- Auto-suggest: get settings, update settings, trigger

Base URL uses Vite proxy in dev, direct URL in production.

### Types (`src/admin/src/types.ts`)

Admin-specific types (copied/adapted from main frontend):
- `AdminTopic`, `AdminTopicsResponse`
- `PendingReview`, `PendingReviewsResponse`
- `ReviewApproveRequest`, `ReviewRejectRequest`, `ReviewRevisionRequest`
- `SchedulerSettings`, `SchedulerSettingsRequest`
- `AutoSuggestSettings`, `AutoSuggestSettingsRequest`
- Plus ClaimCard, BlogPost, Source, CategoryTag for display

### Routing (`src/admin/src/App.tsx`)

Three routes:
- `/topics` → TopicQueuePage
- `/review` → ReviewPage
- `/settings` → SettingsPage
- `/` → redirect to `/topics`

### Navigation (`src/admin/src/components/Navigation.tsx`)

Simple nav bar with three links.
Blue theme (`#1976d2`) to distinguish from main frontend.

---

## Deployment Strategy

**Admin Application:**
- Port: 5174
- Bind: 0.0.0.0 (accessible on internal network)
- No authentication (relies on network-level access control)
- Separate deployment from main frontend
- Can be firewall-restricted or VPN-only

**Main Frontend:**
- Port: 5173
- Public-facing (Ask, Read, Audits only)
- No admin features or links

---

## Running the Admin App

**Development:**
```bash
cd /src/admin
npm run dev -- --host 0.0.0.0
# Accessible at http://192.168.50.10:5174
```

**Note:** User controls service startup (NOT Claude sessions).

---

## Files Created

**Admin App (Standalone):**
- `/src/admin/` (entire directory)
- `vite.config.ts` (port 5174, proxy)
- `src/api.ts` (admin API client, 160 lines)
- `src/types.ts` (admin types, 174 lines)
- `src/components/Navigation.tsx` + `.css`
- `src/pages/TopicQueuePage.tsx` (347 lines) + `.css`
- `src/pages/ReviewPage.tsx` (360 lines) + `.css`
- `src/pages/SettingsPage.tsx` (280 lines) + `.css`
- `src/App.tsx` (routing), `src/App.css`, `src/index.css`

**Main Frontend (Cleaned):**
- Removed admin types from `types/index.ts`
- Removed admin API methods from `services/api.ts`
- Removed admin nav links from `components/TopNav.tsx` + `.css`

---

## Next Steps

**Phase 3.5 (In Progress):**
- Read & Audits Backend (public endpoints)

**Phase 3.7 (Upcoming):**
- Read & Audits UI (public blog articles and claim card repository)

---

## Known Issues

User mentioned "several bugs with admin features" but did not specify details. Will address bugs once admin location fix is verified.

---

**Status:** Admin UI complete as standalone application on port 5174.
